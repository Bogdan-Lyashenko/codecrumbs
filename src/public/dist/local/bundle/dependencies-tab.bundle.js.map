{"version":3,"sources":["webpack://codecrumbs/./js/components/sideBar/component/Code/index.scss","webpack://codecrumbs/./js/components/sideBar/component/DependenciesTab/index.scss","webpack://codecrumbs/../shared/astParse.js","webpack://codecrumbs/./js/components/sideBar/component/Code/index.js","webpack://codecrumbs/./js/components/sideBar/component/Code/index.scss?7735","webpack://codecrumbs/./js/components/sideBar/component/DependenciesTab/index.js","webpack://codecrumbs/./js/components/sideBar/component/DependenciesTab/index.scss?b07c","webpack://codecrumbs/./js/components/sideBar/component/shared/utils.js"],"names":["config","sourceType","plugins","getNodeLines","node","loc","start","line","end","module","exports","FONT_SIZE","props","dependenciesLines","crumbedLines","codeRef","scrollTo","lines","length","prevProps","fixScroll","code","limitedHeight","classNames","el","atomOneLight","fontSize","lineNumber","isMatchLineNumber","className","React","Component","find","Panel","DependenciesTab","selectedNode","filesMap","foldersMap","selectedDependencyEdgeNodes","importedDependencies","filterImportedDependencies","path","fileCode","map","importNodeLines","file","i","fileNode","findFileNode","sourceFile","exportedDependencies","extractExportsForImports","specifiers","mapStateToProps","state","getSource","getSourceUserChoice","getDependenciesUserChoice","connect","babylon","require","babelTraverse","astParseConfig","filter","dependency","sources","source","pathIndexMath","exec","pathName","substr","index","indexOf","completePath","Object","keys","key","ast","parse","isDefaultImported","type","namedImportsNames","name","default","enter","push","declaration","declarations","d","includes","id","e","console","log"],"mappings":";;;;;;;;;AAAA,2BAA2B,mBAAO,CAAC,mHAA8D;AACjG;;;AAGA;AACA,cAAc,QAAS,UAAU,iBAAiB,uBAAuB,mBAAmB,EAAE,wBAAwB,qBAAqB,iDAAiD,EAAE,mCAAmC,qBAAqB,+CAA+C,EAAE,yBAAyB,wBAAwB,EAAE;;AAE1V;;;;;;;;;;;;ACPA,2BAA2B,mBAAO,CAAC,mHAA8D;AACjG;;;AAGA;AACA,cAAc,QAAS,qBAAqB,iBAAiB,EAAE,oCAAoC,yBAAyB,0BAA0B,uBAAuB,qBAAqB,EAAE;;AAEpM;;;;;;;;;;;;ACPA;;AACA;;;;;;;AAOA,IAAMA,MAAM,GAAG;AACbC,YAAU,EAAE,QADC;AAEbC,SAAO,EAAE,CACP,KADO,EAEP,iBAFO,EAGP,iBAHO,EAIP,wBAJO,EAKP,qBALO,EAMP,eANO,EAOP,eAPO,EAQP,mBARO,EASP,qBATO,EAUP,cAVO,EAWP,cAXO,EAYP,YAZO,EAaP,mBAbO,EAcP,2BAdO,EAeP,kBAfO,EAgBP,kBAhBO,EAiBP,sBAjBO,EAkBP,kBAlBO,EAmBP,kBAnBO;AAFI,CAAf;;AAyBA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAAAC,IAAI;AAAA,SAAI,CAACA,IAAI,CAACC,GAAL,CAASC,KAAT,CAAeC,IAAhB,EAAsBH,IAAI,CAACC,GAAL,CAASG,GAAT,CAAaD,IAAnC,CAAJ;AAAA,CAAzB;;AAEAE,MAAM,CAACC,OAAP,GAAiB;AACfV,QAAM,EAANA,MADe;AAEfG,cAAY,EAAZA;AAFe,CAAjB,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnCA;AACA;AACA;AACA;AAEA;AAEA,IAAMQ,SAAS,GAAG,MAAlB,C,CACA;AACA;AACA;;;;;;;;;;;;;;;gCAEc;AAAA,wBAC4C,KAAKC,KADjD;AAAA,8CACFC,iBADE;AAAA,UACFA,iBADE,sCACkB,EADlB;AAAA,8CACsBC,YADtB;AAAA,UACsBA,YADtB,sCACqC,EADrC;;AAEV,UAAI,CAAC,KAAKC,OAAN,IAAiB,CAAC,KAAKA,OAAL,CAAaC,QAAnC,EAA6C;AAC3C;AACD;;AAED,UAAMC,KAAK,GAAGJ,iBAAiB,CAACK,MAAlB,GACVL,iBADU,GAEVC,YAAY,CAACI,MAAb,GACEJ,YADF,GAEE,IAJN;AAMAG,WAAK,IAAI,KAAKF,OAAL,CAAaC,QAAb,CAAsB,CAAtB,EAAyBC,KAAK,CAAC,CAAD,CAAL,CAAS,CAAT,IAAc,EAAd,GAAmB,CAA5C,CAAT;AACD;;;uCACkBE,S,EAAW;AAC5B,WAAKC,SAAL;AACD;;;wCACmB;AAClB,WAAKA,SAAL;AACD;;;6BAEQ;AAAA;;AAAA,yBACoE,KAAKR,KADzE;AAAA,UACCS,IADD,gBACCA,IADD;AAAA,+CACOP,YADP;AAAA,UACOA,YADP,sCACsB,EADtB;AAAA,+CAC0BD,iBAD1B;AAAA,UAC0BA,iBAD1B,sCAC8C,EAD9C;AAAA,UACkDS,aADlD,gBACkDA,aADlD,EAGP;;AACA,aACE;AAAK,iBAAS,EAAEC,iDAAU,CAAC,MAAD,EAAS;AAAED,uBAAa,EAAbA;AAAF,SAAT,CAA1B;AAAuD,WAAG,EAAE,aAAAE,EAAE;AAAA,iBAAK,KAAI,CAACT,OAAL,GAAeS,EAApB;AAAA;AAA9D,SACE,2DAAC,+DAAD;AACE,gBAAQ,EAAC,YADX;AAEE,aAAK,EAAEC,iFAFT;AAGE,uBAAe,EAAE,IAHnB;AAIE,iBAAS,EAAE,IAJb;AAKE,mBAAW,EAAE;AAAEC,kBAAQ,EAAEf;AAAZ,SALf;AAME,iBAAS,EAAE,mBAAAgB,UAAU,EAAI;AACvB,cAAIC,iBAAiB,CAACd,YAAD,EAAea,UAAf,CAArB,EAAiD;AAC/C,mBAAO;AAAEE,uBAAS,EAAE;AAAb,aAAP;AACD;;AAED,cAAID,iBAAiB,CAACf,iBAAD,EAAoBc,UAApB,CAArB,EAAsD;AACpD,mBAAO;AAAEE,uBAAS,EAAE;AAAb,aAAP;AACD;;AAED,iBAAO,EAAP;AACD;AAhBH,SAkBGR,IAlBH,CADF,CADF;AAwBD;;;;EAlD0BS,4CAAK,CAACC,S;;;;AAqDnC,IAAMH,iBAAiB,GAAG,SAApBA,iBAAoB,CAACX,KAAD,EAAQU,UAAR;AAAA,SACxB,CAAC,CAACV,KAAK,CAACe,IAAN,CAAW,UAAAf,KAAK,EAAI;AACpB,QAAIA,KAAK,CAAC,CAAD,CAAL,KAAaU,UAAb,IAA2BV,KAAK,CAAC,CAAD,CAAL,KAAaU,UAA5C,EAAwD;AACtD,aAAO,IAAP;AACD;;AACD,WAAOV,KAAK,CAAC,CAAD,CAAL,IAAYU,UAAZ,IAA0BV,KAAK,CAAC,CAAD,CAAL,IAAYU,UAA7C;AACD,GALC,CADsB;AAAA,CAA1B,C;;;;;;;;;;;;AC/DA,cAAc,mBAAO,CAAC,qQAAkI;;AAExJ,4CAA4C,QAAS;;AAErD;AACA;;;;AAIA,eAAe;;AAEf;AACA;;AAEA,aAAa,mBAAO,CAAC,yHAAkE;;AAEvF;;AAEA,GAAG,KAAU,EAAE,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnBf;AACA;AAGA;AAEA;AACA;AAKA;AAEA,IAAMM,KAAK,GAAG,yDAASA,KAAvB;;AAEA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAAAtB,KAAK,EAAI;AAAA,MACvBuB,YADuB,GAC6CvB,KAD7C,CACvBuB,YADuB;AAAA,MACTC,QADS,GAC6CxB,KAD7C,CACTwB,QADS;AAAA,MACCC,UADD,GAC6CzB,KAD7C,CACCyB,UADD;AAAA,MACaC,2BADb,GAC6C1B,KAD7C,CACa0B,2BADb;AAG/B,MAAMC,oBAAoB,GAAGC,gFAA0B,CACrDL,YAAY,CAACI,oBADwC,EAErDD,2BAFqD,CAAvD;AAKA,SACE;AAAK,aAAS,EAAE;AAAhB,KACGC,oBAAoB,CAACrB,MAArB,GACC;AAAU,YAAQ,EAAE,KAApB;AAA2B,oBAAgB,EAAE,CAAC,GAAD,EAAM,GAAN;AAA7C,KACE,2DAAC,KAAD;AAAO,UAAM,EAAEiB,YAAY,CAACM,IAA5B;AAAkC,OAAG,EAAC;AAAtC,KACE,2DAAC,6CAAD;AACE,iBAAa,EAAE,IADjB;AAEE,QAAI,EAAEN,YAAY,CAACO,QAFrB;AAGE,qBAAiB,EAAEH,oBAAoB,CAACI,GAArB,CAAyB;AAAA,UAAGC,eAAH,QAAGA,eAAH;AAAA,aAAyBA,eAAzB;AAAA,KAAzB;AAHrB,IADF,CADF,EAQGL,oBAAoB,CAACI,GAArB,CAAyB,UAACE,IAAD,EAAOC,CAAP,EAAa;AACrC;AACA,QAAMC,QAAQ,GAAGC,kEAAY,CAACH,IAAI,CAACI,UAAN,EAAkBb,QAAlB,EAA4BC,UAA5B,CAA7B;;AAEA,QAAI,CAACU,QAAL,EAAe;AACb,aAAO,IAAP;AACD;;AAED,QAAMG,oBAAoB,GAAGC,8EAAwB,CACnDJ,QAAQ,CAACL,QAD0C,EAEnDG,IAAI,CAACO,UAF8C,EAGnDP,IAAI,CAACI,UAH8C,CAArD;AAKA,WACE,2DAAC,KAAD;AAAO,YAAM,EAAEF,QAAQ,CAACN,IAAxB;AAA8B,SAAG,EAAEK,CAAC,GAAG;AAAvC,OACE,2DAAC,6CAAD;AACE,mBAAa,EAAE,IADjB;AAEE,UAAI,EAAEC,QAAQ,CAACL,QAAT,IAAqB,EAF7B;AAGE,uBAAiB,EAAEQ;AAHrB,MADF,CADF;AASD,GAtBA,CARH,CADD,GAkCC;AACE,WAAO,EAAC,gFADV;AAEE,QAAI,EAAC,MAFP;AAGE,YAAQ;AAHV,IAnCJ,CADF;AA4CD,CApDD;;AAsDA,IAAMG,eAAe,GAAG,SAAlBA,eAAkB,CAACC,KAAD,EAAQ1C,KAAR,EAAkB;AAAA,mBACP2C,wEAAS,CAACD,KAAD,EAAQ1C,KAAR,CADF;AAAA,MAChCwB,QADgC,cAChCA,QADgC;AAAA,MACtBC,UADsB,cACtBA,UADsB;;AAAA,6BAEfmB,kFAAmB,CAACF,KAAD,EAAQ1C,KAAR,CAFJ;AAAA,MAEhCuB,YAFgC,wBAEhCA,YAFgC;;AAAA,8BAGAsB,wFAAyB,CAACH,KAAD,EAAQ1C,KAAR,CAHzB;AAAA,MAGhC0B,2BAHgC,yBAGhCA,2BAHgC;;AAKxC,SAAO;AACLH,gBAAY,EAAZA,YADK;AAELG,+BAA2B,EAA3BA,2BAFK;AAGLF,YAAQ,EAARA,QAHK;AAILC,cAAU,EAAVA;AAJK,GAAP;AAMD,CAXD;;AAaeqB,0HAAO,CAACL,eAAD,CAAP,CAAyBnB,eAAzB,CAAf,E;;;;;;;;;;;;AClFA,cAAc,mBAAO,CAAC,gRAAkI;;AAExJ,4CAA4C,QAAS;;AAErD;AACA;;;;AAIA,eAAe;;AAEf;AACA;;AAEA,aAAa,mBAAO,CAAC,yHAAkE;;AAEvF;;AAEA,GAAG,KAAU,EAAE,E;;;;;;;;;;;;ACnBf;AAAA;AAAA;AAAA;AAAA,IAAMyB,OAAO,GAAGC,mBAAO,CAAC,oEAAD,CAAvB;;AACA,IAAMC,aAAa,GAAGD,mBAAO,CAAC,wEAAD,CAA7B;;eAEiDA,mBAAO,CAAC,8DAAD,C;IAAxCE,c,YAAR9D,M;IAAwBG,Y,YAAAA,Y;;AAEzB,IAAMqC,0BAA0B,GAAG,SAA7BA,0BAA6B,GAGrC;AAAA,MAFHD,oBAEG,uEAFoB,EAEpB;AAAA,MADHD,2BACG;;AACH,MAAI,CAACA,2BAAL,EAAkC;AAChC,WAAO,EAAP;AACD;;AAED,SAAOC,oBAAoB,CAACwB,MAArB,CAA4B,UAAAC,UAAU,EAAI;AAAA,QACvCC,OADuC,GAC3B3B,2BAD2B,CACvC2B,OADuC;AAE/C,WAAOA,OAAO,CAACjC,IAAR,CAAa,UAAAkC,MAAM,EAAI;AAC5B,UAAMC,aAAa,GAAG,KAAKC,IAAL,CAAUJ,UAAU,CAACf,UAArB,CAAtB;AACA,UAAMoB,QAAQ,GAAGL,UAAU,CAACf,UAAX,CAAsBqB,MAAtB,CAA6BH,aAAa,IAAIA,aAAa,CAACI,KAA5D,CAAjB;AACA,aAAOL,MAAM,CAACM,OAAP,CAAeH,QAAf,MAA6B,CAAC,CAArC;AACD,KAJM,CAAP;AAKD,GAPM,CAAP;AAQD,CAhBM;AAkBA,IAAMrB,YAAY,GAAG,SAAfA,YAAe,CAACP,IAAD,EAAOL,QAAP,EAAiBC,UAAjB,EAAgC;AAC1D,MAAIA,UAAU,CAACI,IAAD,CAAd,EAAsB;AACpBA,QAAI,IAAI,QAAR;AACD;;AAED,MAAIL,QAAQ,CAACK,IAAD,CAAZ,EAAoB;AAClB,WAAOL,QAAQ,CAACK,IAAD,CAAf;AACD;;AAED,MAAMgC,YAAY,GAAGC,MAAM,CAACC,IAAP,CAAYvC,QAAZ,EAAsBJ,IAAtB,CAA2B,UAAA4C,GAAG;AAAA,WAAIA,GAAG,CAACJ,OAAJ,CAAY/B,IAAZ,MAAsB,CAA1B;AAAA,GAA9B,CAArB;AACA,SAAOL,QAAQ,CAACqC,YAAD,CAAf;AACD,CAXM;AAaA,IAAMtB,wBAAwB,GAAG,SAA3BA,wBAA2B,CAACT,QAAD,EAAWU,UAAX,EAAuBX,IAAvB,EAAgC;AACtE,MAAIoC,GAAG,GAAG,EAAV;AACA,MAAMnE,OAAO,GAAG,EAAhB;;AAEA,MAAI;AACFmE,OAAG,GAAGlB,OAAO,CAACmB,KAAR,CAAcpC,QAAd,EAAwBoB,cAAxB,CAAN;AAEA,QAAMiB,iBAAiB,GAAG,CAAC,CAAC3B,UAAU,CAACpB,IAAX,CAAgB;AAAA,UAAGgD,IAAH,QAAGA,IAAH;AAAA,aAAcA,IAAI,KAAK,wBAAvB;AAAA,KAAhB,CAA5B;AACA,QAAMC,iBAAiB,GAAG7B,UAAU,CACjCW,MADuB,CAChB;AAAA,UAAGiB,IAAH,SAAGA,IAAH;AAAA,aAAcA,IAAI,KAAK,iBAAvB;AAAA,KADgB,EAEvBrC,GAFuB,CAEnB;AAAA,UAAGuC,IAAH,SAAGA,IAAH;AAAA,aAAcA,IAAd;AAAA,KAFmB,CAA1B;AAIArB,iBAAa,CAACsB,OAAd,CAAsBN,GAAtB,EAA2B;AACzBO,WADyB,iBACnB3C,IADmB,EACb;AACV,YAAMrC,IAAI,GAAGqC,IAAI,CAACrC,IAAlB;;AAEA,YAAI2E,iBAAiB,IAAI3E,IAAI,CAAC4E,IAAL,KAAc,0BAAvC,EAAmE;AACjEtE,iBAAO,CAAC2E,IAAR,CAAajF,IAAb;AACD,SAFD,MAEO,IAAIA,IAAI,CAAC4E,IAAL,KAAc,wBAAlB,EAA4C;AACjD,cAAMM,WAAW,GACflF,IAAI,CAACkF,WAAL,IACAlF,IAAI,CAACkF,WAAL,CAAiBC,YAAjB,CAA8BvD,IAA9B,CAAmC,UAAAwD,CAAC;AAAA,mBAAIP,iBAAiB,CAACQ,QAAlB,CAA2BD,CAAC,CAACE,EAAF,CAAKR,IAAhC,CAAJ;AAAA,WAApC,CAFF;;AAGA,cAAII,WAAJ,EAAiB;AACf5E,mBAAO,CAAC2E,IAAR,CAAajF,IAAb;AACD;AACF;AACF;AAdwB,KAA3B;AAiBA,WAAOM,OAAO,CAACiC,GAAR,CAAYxC,YAAZ,CAAP;AACD,GA1BD,CA0BE,OAAOwF,CAAP,EAAU;AACVC,WAAO,CAACC,GAAR,CAAYpD,IAAZ,EAAkBkD,CAAlB;AACA,WAAOjF,OAAP;AACD;AACF,CAlCM,C","file":"dependencies-tab.bundle.js","sourcesContent":["exports = module.exports = require(\"../../../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".Code {\\n  height: 100%;\\n  position: relative;\\n  overflow: auto; }\\n  .Code .crumbedLine {\\n    display: block;\\n    background-color: rgba(255, 225, 244, 0.8); }\\n  .Code .importedDependencyLine {\\n    display: block;\\n    background-color: rgba(0, 148, 249, 0.1); }\\n  .Code.limitedHeight {\\n    max-height: 200px; }\\n\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".DependenciesTab {\\n  height: 100%; }\\n  .DependenciesTab .ant-collapse {\\n    margin-left: -16px;\\n    margin-right: -16px;\\n    max-height: 100%;\\n    overflow: auto; }\\n\", \"\"]);\n\n// exports\n","// TODO: add by config\n/**\n [\n 'typescript',\n 'flow',\n 'bigInt',\n ]\n */\nconst config = {\n  sourceType: 'module',\n  plugins: [\n    'jsx',\n    'asyncGenerators',\n    'classProperties',\n    'classPrivateProperties',\n    'classPrivateMethods',\n    'doExpressions',\n    'dynamicImport',\n    'exportDefaultFrom',\n    'exportNamespaceFrom',\n    'functionBind',\n    'functionSent',\n    'importMeta',\n    'logicalAssignment',\n    'nullishCoalescingOperator',\n    'numericSeparator',\n    'objectRestSpread',\n    'optionalCatchBinding',\n    'optionalChaining',\n    'throwExpressions'\n  ]\n};\n\nconst getNodeLines = node => [node.loc.start.line, node.loc.end.line];\n\nmodule.exports = {\n  config,\n  getNodeLines\n};\n","import React from 'react';\nimport classNames from 'classnames';\nimport SyntaxHighlighter from 'react-syntax-highlighter';\nimport { atomOneLight } from 'react-syntax-highlighter/styles/hljs';\n\nimport './index.scss';\n\nconst FONT_SIZE = '12px';\n//TODO: add select with several themes\n//TODO: scrool to/highlight crumbed lines\n//https://github.com/conorhastings/react-syntax-highlighter/blob/master/README.md\nexport default class extends React.Component {\n  fixScroll() {\n    const { dependenciesLines = [], crumbedLines = [] } = this.props;\n    if (!this.codeRef || !this.codeRef.scrollTo) {\n      return;\n    }\n\n    const lines = dependenciesLines.length\n      ? dependenciesLines\n      : crumbedLines.length\n        ? crumbedLines\n        : null;\n\n    lines && this.codeRef.scrollTo(0, lines[0][0] * 15 - 5);\n  }\n  componentDidUpdate(prevProps) {\n    this.fixScroll();\n  }\n  componentDidMount() {\n    this.fixScroll();\n  }\n\n  render() {\n    const { code, crumbedLines = [], dependenciesLines = [], limitedHeight } = this.props;\n\n    // TODO: calc height for .Code based on dependenciesLines - it's not always need to be 300 px!!\n    return (\n      <div className={classNames('Code', { limitedHeight })} ref={el => (this.codeRef = el)}>\n        <SyntaxHighlighter\n          language=\"javascript\"\n          style={atomOneLight}\n          showLineNumbers={true}\n          wrapLines={true}\n          customStyle={{ fontSize: FONT_SIZE }}\n          lineProps={lineNumber => {\n            if (isMatchLineNumber(crumbedLines, lineNumber)) {\n              return { className: 'crumbedLine' };\n            }\n\n            if (isMatchLineNumber(dependenciesLines, lineNumber)) {\n              return { className: 'importedDependencyLine' };\n            }\n\n            return {};\n          }}\n        >\n          {code}\n        </SyntaxHighlighter>\n      </div>\n    );\n  }\n}\n\nconst isMatchLineNumber = (lines, lineNumber) =>\n  !!lines.find(lines => {\n    if (lines[0] === lineNumber && lines[1] === lineNumber) {\n      return true;\n    }\n    return lines[0] <= lineNumber && lines[1] >= lineNumber;\n  });\n","\nvar content = require(\"!!../../../../../../../node_modules/css-loader/index.js!../../../../../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../../../node_modules/css-loader/index.js!../../../../../../../node_modules/sass-loader/lib/loader.js!./index.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../../../node_modules/css-loader/index.js!../../../../../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","import React from 'react';\nimport { connect } from 'react-redux';\nimport { Collapse, Alert } from 'antd';\n\nimport { getSource, getSourceUserChoice, getDependenciesUserChoice } from 'core/dataBus/selectors';\n\nimport Code from '../Code';\nimport {\n  filterImportedDependencies,\n  findFileNode,\n  extractExportsForImports\n} from '../shared/utils';\nimport './index.scss';\n\nconst Panel = Collapse.Panel;\n\nconst DependenciesTab = props => {\n  const { selectedNode, filesMap, foldersMap, selectedDependencyEdgeNodes } = props;\n\n  const importedDependencies = filterImportedDependencies(\n    selectedNode.importedDependencies,\n    selectedDependencyEdgeNodes\n  );\n\n  return (\n    <div className={'DependenciesTab'}>\n      {importedDependencies.length ? (\n        <Collapse bordered={false} defaultActiveKey={['0', '1']}>\n          <Panel header={selectedNode.path} key=\"0\">\n            <Code\n              limitedHeight={true}\n              code={selectedNode.fileCode}\n              dependenciesLines={importedDependencies.map(({ importNodeLines }) => importNodeLines)}\n            />\n          </Panel>\n          {importedDependencies.map((file, i) => {\n            // TODO: extract code from server before\n            const fileNode = findFileNode(file.sourceFile, filesMap, foldersMap);\n\n            if (!fileNode) {\n              return null;\n            }\n\n            const exportedDependencies = extractExportsForImports(\n              fileNode.fileCode,\n              file.specifiers,\n              file.sourceFile\n            );\n            return (\n              <Panel header={fileNode.path} key={i + 1}>\n                <Code\n                  limitedHeight={true}\n                  code={fileNode.fileCode || ''}\n                  dependenciesLines={exportedDependencies}\n                />\n              </Panel>\n            );\n          })}\n        </Collapse>\n      ) : (\n        <Alert\n          message=\"C-mon, my dear friend, select dependency connection, what are you waiting for?\"\n          type=\"info\"\n          showIcon\n        />\n      )}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  const { filesMap, foldersMap } = getSource(state, props);\n  const { selectedNode } = getSourceUserChoice(state, props);\n  const { selectedDependencyEdgeNodes } = getDependenciesUserChoice(state, props);\n\n  return {\n    selectedNode,\n    selectedDependencyEdgeNodes,\n    filesMap,\n    foldersMap\n  };\n};\n\nexport default connect(mapStateToProps)(DependenciesTab);\n","\nvar content = require(\"!!../../../../../../../node_modules/css-loader/index.js!../../../../../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../../../node_modules/css-loader/index.js!../../../../../../../node_modules/sass-loader/lib/loader.js!./index.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../../../node_modules/css-loader/index.js!../../../../../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","const babylon = require('@babel/parser');\nconst babelTraverse = require('@babel/traverse');\n\nconst { config: astParseConfig, getNodeLines } = require('shared-with-server-src/astParse');\n\nexport const filterImportedDependencies = (\n  importedDependencies = [],\n  selectedDependencyEdgeNodes\n) => {\n  if (!selectedDependencyEdgeNodes) {\n    return [];\n  }\n\n  return importedDependencies.filter(dependency => {\n    const { sources } = selectedDependencyEdgeNodes;\n    return sources.find(source => {\n      const pathIndexMath = /\\w/.exec(dependency.sourceFile);\n      const pathName = dependency.sourceFile.substr(pathIndexMath && pathIndexMath.index);\n      return source.indexOf(pathName) !== -1;\n    });\n  });\n};\n\nexport const findFileNode = (path, filesMap, foldersMap) => {\n  if (foldersMap[path]) {\n    path += '/index';\n  }\n\n  if (filesMap[path]) {\n    return filesMap[path];\n  }\n\n  const completePath = Object.keys(filesMap).find(key => key.indexOf(path) === 0);\n  return filesMap[completePath];\n};\n\nexport const extractExportsForImports = (fileCode, specifiers, path) => {\n  let ast = {};\n  const exports = [];\n\n  try {\n    ast = babylon.parse(fileCode, astParseConfig);\n\n    const isDefaultImported = !!specifiers.find(({ type }) => type === 'ImportDefaultSpecifier');\n    const namedImportsNames = specifiers\n      .filter(({ type }) => type === 'ImportSpecifier')\n      .map(({ name }) => name);\n\n    babelTraverse.default(ast, {\n      enter(path) {\n        const node = path.node;\n\n        if (isDefaultImported && node.type === 'ExportDefaultDeclaration') {\n          exports.push(node);\n        } else if (node.type === 'ExportNamedDeclaration') {\n          const declaration =\n            node.declaration &&\n            node.declaration.declarations.find(d => namedImportsNames.includes(d.id.name));\n          if (declaration) {\n            exports.push(node);\n          }\n        }\n      }\n    });\n\n    return exports.map(getNodeLines);\n  } catch (e) {\n    console.log(path, e);\n    return exports;\n  }\n};\n"],"sourceRoot":""}